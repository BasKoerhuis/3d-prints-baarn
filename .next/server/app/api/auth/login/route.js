"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},813:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{POST:()=>c});var n=t(9303),o=t(8716),a=t(670),u=t(7070),i=t(9178);async function c(e){try{let{username:r,password:t}=await e.json();if(!r||!t)return u.NextResponse.json({success:!1,error:"Gebruikersnaam en wachtwoord zijn verplicht"},{status:400});if(!await (0,i.xH)(r,t))return u.NextResponse.json({success:!1,error:"Ongeldige inloggegevens"},{status:401});let s=await (0,i.V3)({username:r}),n=u.NextResponse.json({success:!0,message:"Succesvol ingelogd"});return n.cookies.set("admin_token",s,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:86400}),n}catch(e){return console.error("Login error:",e),u.NextResponse.json({success:!1,error:"Server error"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/Users/baskoerhuis/jelte3D/app/api/auth/login/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:g}=p,h="/api/auth/login/route";function x(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}},9178:(e,r,t)=>{t.d(r,{T7:()=>l,V3:()=>i,WX:()=>c,xH:()=>d});var s=t(6091),n=t(6176),o=t(2023),a=t.n(o);let u=new TextEncoder().encode(process.env.JWT_SECRET||"your-secret-key-min-32-characters-long");async function i(e){return await new s.N(e).setProtectedHeader({alg:"HS256"}).setExpirationTime("24h").setIssuedAt().sign(u)}async function c(e){try{return(await (0,n._)(e,u)).payload}catch(e){return null}}async function p(e,r){return a().compare(e,r)}function l(){let e=process.env.ADMIN_PASSWORD_HASH||"";return process.env.ADMIN_PASSWORD_HASH_BASE64&&(e=Buffer.from(process.env.ADMIN_PASSWORD_HASH_BASE64,"base64").toString("utf-8")),e||(e="$2a$10$YourDefaultHashHere"),{username:process.env.ADMIN_USERNAME||"admin",passwordHash:e}}async function d(e,r){let t=l();return e===t.username&&p(r,t.passwordHash)}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,972,391],()=>t(813));module.exports=s})();