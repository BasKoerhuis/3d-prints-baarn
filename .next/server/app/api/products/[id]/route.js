"use strict";(()=>{var e={};e.id=898,e.ids=[898],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},1017:e=>{e.exports=require("path")},2763:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>S,routeModule:()=>f,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{DELETE:()=>p,GET:()=>d,PUT:()=>l});var s=r(9303),i=r(8716),o=r(670),u=r(7070),c=r(8569),a=r(6982);async function d(e,{params:t}){try{let e=(0,c.gk)(t.id);if(!e)return u.NextResponse.json({success:!1,error:"Product not found"},{status:404});return u.NextResponse.json({success:!0,data:e})}catch(e){return u.NextResponse.json({success:!1,error:"Failed to fetch product"},{status:500})}}async function l(e,{params:t}){let r=await (0,a.k)(e);if(r)return r;try{let r=await e.json(),n={...r.name&&{name:r.name},...r.shortDescription&&{shortDescription:r.shortDescription},...r.longDescription&&{longDescription:r.longDescription},...r.dimensions&&{dimensions:r.dimensions},...r.features&&{features:r.features},...void 0!==r.priceChild&&{priceChild:parseFloat(r.priceChild)},...void 0!==r.priceAdult&&{priceAdult:parseFloat(r.priceAdult)},...r.images&&{images:r.images},...void 0!==r.inStock&&{inStock:r.inStock}},s=(0,c.nM)(t.id,n);if(!s)return u.NextResponse.json({success:!1,error:"Product not found"},{status:404});return u.NextResponse.json({success:!0,data:s})}catch(e){return console.error("Error updating product:",e),u.NextResponse.json({success:!1,error:"Failed to update product"},{status:500})}}async function p(e,{params:t}){let r=await (0,a.k)(e);if(r)return r;try{if(!(0,c.Ir)(t.id))return u.NextResponse.json({success:!1,error:"Product not found"},{status:404});return u.NextResponse.json({success:!0,message:"Product deleted successfully"})}catch(e){return console.error("Error deleting product:",e),u.NextResponse.json({success:!1,error:"Failed to delete product"},{status:500})}}let f=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/products/[id]/route",pathname:"/api/products/[id]",filename:"route",bundlePath:"app/api/products/[id]/route"},resolvedPagePath:"/Users/baskoerhuis/jelte3D/app/api/products/[id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:S,staticGenerationAsyncStorage:g,serverHooks:y}=f,h="/api/products/[id]/route";function x(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},6982:(e,t,r)=>{r.d(t,{k:()=>o});var n=r(7070),s=r(9178);async function i(e){let t=e.cookies.get("admin_token")?.value;return!!t&&null!==await (0,s.WX)(t)}async function o(e){return await i(e)?null:n.NextResponse.json({success:!1,error:"Unauthorized"},{status:401})}},9178:(e,t,r)=>{r.d(t,{T7:()=>l,V3:()=>c,WX:()=>a,xH:()=>p});var n=r(6091),s=r(6176),i=r(2023),o=r.n(i);let u=new TextEncoder().encode(process.env.JWT_SECRET||"your-secret-key-min-32-characters-long");async function c(e){return await new n.N(e).setProtectedHeader({alg:"HS256"}).setExpirationTime("24h").setIssuedAt().sign(u)}async function a(e){try{return(await (0,s._)(e,u)).payload}catch(e){return null}}async function d(e,t){return o().compare(e,t)}function l(){let e=process.env.ADMIN_PASSWORD_HASH||"";return process.env.ADMIN_PASSWORD_HASH_BASE64&&(e=Buffer.from(process.env.ADMIN_PASSWORD_HASH_BASE64,"base64").toString("utf-8")),e||(e="$2a$10$YourDefaultHashHere"),{username:process.env.ADMIN_USERNAME||"admin",passwordHash:e}}async function p(e,t){let r=l();return e===r.username&&d(t,r.passwordHash)}},8569:(e,t,r)=>{r.d(t,{Dg:()=>l,Fn:()=>m,GD:()=>N,Ir:()=>g,gk:()=>p,kK:()=>x,nM:()=>S,ry:()=>f,tS:()=>h,vR:()=>y,vX:()=>w});var n=r(7147),s=r.n(n),i=r(1017),o=r.n(i);let u=o().join(process.cwd(),"data"),c=o().join(u,"products.json"),a=o().join(u,"gallery.json");function d(){s().existsSync(u)||s().mkdirSync(u,{recursive:!0}),s().existsSync(c)||s().writeFileSync(c,JSON.stringify([])),s().existsSync(a)||s().writeFileSync(a,JSON.stringify([]))}function l(){d();try{let e=s().readFileSync(c,"utf-8");return JSON.parse(e)}catch(e){return[]}}function p(e){return l().find(t=>t.id===e)||null}function f(e){let t=l(),r={...e,id:A(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return t.push(r),s().writeFileSync(c,JSON.stringify(t,null,2)),r}function S(e,t){let r=l(),n=r.findIndex(t=>t.id===e);return -1===n?null:(r[n]={...r[n],...t,id:r[n].id,createdAt:r[n].createdAt,updatedAt:new Date().toISOString()},s().writeFileSync(c,JSON.stringify(r,null,2)),r[n])}function g(e){let t=l(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(s().writeFileSync(c,JSON.stringify(r,null,2)),!0)}function y(){d();try{let e=s().readFileSync(a,"utf-8");return JSON.parse(e)}catch(e){return[]}}function h(e){return y().find(t=>t.id===e)||null}function x(e){let t=y(),r={...e,id:A(),uploadedAt:new Date().toISOString()};return t.push(r),s().writeFileSync(a,JSON.stringify(t,null,2)),r}function m(e,t){let r=y(),n=r.findIndex(t=>t.id===e);return -1===n?null:(r[n]={...r[n],...t,id:r[n].id,uploadedAt:r[n].uploadedAt},s().writeFileSync(a,JSON.stringify(r,null,2)),r[n])}function w(e){let t=y(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(s().writeFileSync(a,JSON.stringify(r,null,2)),!0)}function A(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function N(e){return e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972,391],()=>r(2763));module.exports=n})();