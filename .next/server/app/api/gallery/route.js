"use strict";(()=>{var e={};e.id=936,e.ids=[936],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},3292:e=>{e.exports=require("fs/promises")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},1017:e=>{e.exports=require("path")},4781:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>x,requestAsyncStorage:()=>S,routeModule:()=>y,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var n={};r.r(n),r.d(n,{GET:()=>f,POST:()=>g});var i=r(9303),s=r(8716),a=r(670),o=r(7070),u=r(8569),l=r(6982),c=r(3292),d=r(1017),p=r.n(d);async function f(){try{let e=(0,u.vR)();return o.NextResponse.json({success:!0,data:e})}catch(e){return o.NextResponse.json({success:!1,error:"Failed to fetch gallery images"},{status:500})}}async function g(e){let t=await (0,l.k)(e);if(t)return t;try{let t=await e.formData(),r=t.getAll("files"),n=t.get("alt")||"",i=t.get("tags")||"";if(!r||0===r.length)return o.NextResponse.json({success:!1,error:"No files provided"},{status:400});let s=[];for(let e of r){if(!e||0===e.size)continue;let t=Date.now(),r=Math.random().toString(36).substring(2,8),a=p().extname(e.name),o=`gallery-${t}-${r}${a}`,l=await e.arrayBuffer(),d=Buffer.from(l),f=p().join(process.cwd(),"public","uploads","gallery",o);await (0,c.writeFile)(f,d);let g=(0,u.kK)({filename:o,path:`/uploads/gallery/${o}`,alt:n||e.name,tags:i?i.split(",").map(e=>e.trim()):[]});s.push(g)}return o.NextResponse.json({success:!0,data:s,message:`${s.length} afbeelding(en) ge\xfcpload`})}catch(e){return console.error("Error uploading images:",e),o.NextResponse.json({success:!1,error:"Failed to upload images"},{status:500})}}let y=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/gallery/route",pathname:"/api/gallery",filename:"route",bundlePath:"app/api/gallery/route"},resolvedPagePath:"/Users/baskoerhuis/jelte3D/app/api/gallery/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:S,staticGenerationAsyncStorage:h,serverHooks:m}=y,w="/api/gallery/route";function x(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},6982:(e,t,r)=>{r.d(t,{k:()=>a});var n=r(7070),i=r(9178);async function s(e){let t=e.cookies.get("admin_token")?.value;return!!t&&null!==await (0,i.WX)(t)}async function a(e){return await s(e)?null:n.NextResponse.json({success:!1,error:"Unauthorized"},{status:401})}},9178:(e,t,r)=>{r.d(t,{T7:()=>d,V3:()=>u,WX:()=>l,xH:()=>p});var n=r(6091),i=r(6176),s=r(2023),a=r.n(s);let o=new TextEncoder().encode(process.env.JWT_SECRET||"your-secret-key-min-32-characters-long");async function u(e){return await new n.N(e).setProtectedHeader({alg:"HS256"}).setExpirationTime("24h").setIssuedAt().sign(o)}async function l(e){try{return(await (0,i._)(e,o)).payload}catch(e){return null}}async function c(e,t){return a().compare(e,t)}function d(){let e=process.env.ADMIN_PASSWORD_HASH||"";return process.env.ADMIN_PASSWORD_HASH_BASE64&&(e=Buffer.from(process.env.ADMIN_PASSWORD_HASH_BASE64,"base64").toString("utf-8")),e||(e="$2a$10$YourDefaultHashHere"),{username:process.env.ADMIN_USERNAME||"admin",passwordHash:e}}async function p(e,t){let r=d();return e===r.username&&c(t,r.passwordHash)}},8569:(e,t,r)=>{r.d(t,{Dg:()=>d,Fn:()=>w,GD:()=>v,Ir:()=>y,gk:()=>p,kK:()=>m,nM:()=>g,ry:()=>f,tS:()=>h,vR:()=>S,vX:()=>x});var n=r(7147),i=r.n(n),s=r(1017),a=r.n(s);let o=a().join(process.cwd(),"data"),u=a().join(o,"products.json"),l=a().join(o,"gallery.json");function c(){i().existsSync(o)||i().mkdirSync(o,{recursive:!0}),i().existsSync(u)||i().writeFileSync(u,JSON.stringify([])),i().existsSync(l)||i().writeFileSync(l,JSON.stringify([]))}function d(){c();try{let e=i().readFileSync(u,"utf-8");return JSON.parse(e)}catch(e){return[]}}function p(e){return d().find(t=>t.id===e)||null}function f(e){let t=d(),r={...e,id:A(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return t.push(r),i().writeFileSync(u,JSON.stringify(t,null,2)),r}function g(e,t){let r=d(),n=r.findIndex(t=>t.id===e);return -1===n?null:(r[n]={...r[n],...t,id:r[n].id,createdAt:r[n].createdAt,updatedAt:new Date().toISOString()},i().writeFileSync(u,JSON.stringify(r,null,2)),r[n])}function y(e){let t=d(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(i().writeFileSync(u,JSON.stringify(r,null,2)),!0)}function S(){c();try{let e=i().readFileSync(l,"utf-8");return JSON.parse(e)}catch(e){return[]}}function h(e){return S().find(t=>t.id===e)||null}function m(e){let t=S(),r={...e,id:A(),uploadedAt:new Date().toISOString()};return t.push(r),i().writeFileSync(l,JSON.stringify(t,null,2)),r}function w(e,t){let r=S(),n=r.findIndex(t=>t.id===e);return -1===n?null:(r[n]={...r[n],...t,id:r[n].id,uploadedAt:r[n].uploadedAt},i().writeFileSync(l,JSON.stringify(r,null,2)),r[n])}function x(e){let t=S(),r=t.filter(t=>t.id!==e);return r.length!==t.length&&(i().writeFileSync(l,JSON.stringify(r,null,2)),!0)}function A(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function v(e){return e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972,391],()=>r(4781));module.exports=n})();